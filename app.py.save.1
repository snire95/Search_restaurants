from flask import Flask
from flask import render_template
from flask import request, jsonify, make_response
import mysql.connector

app = Flask(__name__)

@app.route('/')
def home():
    return render_template('game.html')

@app.route('/newRoom', methods=["POST"])
def saveName():
    mydb = mysql.connector.connect(
        host="localhost",
        user="root",
        password="password",
        database="four_in_a_row"
    )
    name1 = request.get_json()
    cursor = mydb.cursor()
    sql = "INSERT INTO game (name1, player, finesh) VALUES (%s, %s, %s)"
    val = (name1, "1", 0)
    cursor.execute(sql, val)
    mydb.commit()
    res = make_response(jsonify(cursor.lastrowid), 200)
    return 
@app.route("/id/<int:user_id>")
def openGmaeID(user_id):
    return render_template('room.html')

@app.route("/Room/create-room", methods=["POST"])
def newRoom():
    mydb = mysql.connector.connect(
        host="localhost",
        user="root",
        password="password",
        database="four_in_a_row"
    )
    name1 = request.get_json()
    print(name1)

    cursor = mydb.cursor()
    sql = "INSERT INTO game (name1, player, finesh) VALUES (%s, %s, %s)"
    val = (name1, "1", 0)
    cursor.execute(sql, val)
    mydb.commit()
    print("test 1")
#    records = cursor.fetchall()
    print("test 2")
 #   for record in records:
  #      print(record)
    res = make_response(jsonify(cursor.lastrowid), 200)
    print("1 record inserted, ID:", cursor.lastrowid)

    return res   


# from flask import request, jsonify, make_response


# mydb = mysql.connector.connect(
#   host="localhost",
#   user="root",
#   password="password",
#   database="four_in_a_row"
# )

#sql = "INSERT INTO game (array, player, finish) VALUES (%s, %s, %s)"
#val = ("[[blue,red,0,0],[blue,blue,red,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]", "1", "0")
#mycursor.execute(sql, val)

#mydb.commit()
#print("1 record inserted, ID:", mycursor.lastrowid)
 
@app.route("/Room/<name>")
def create_entry(name):
    # req = request.get_json()
    # res = make_response(jsonify(req), 200)
    return render_template('room.html')

# @app.route("/Room/<name>/nweTable")
# def create_entry():




if __name__ == "__main__":
    app.run(host ='0.0.0.0') 



